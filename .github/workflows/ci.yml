name: "Terraform Deployment"
on:
  workflow_dispatch:
jobs:
  terraform:
        runs-on: ubuntu-latest
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          AWS_DEFAULT_REGION: us-east-2
        steps:
            - uses: actions/checkout@v2
            - uses: hashicorp/setup-terraform@v1
              with:
                terraform_wrapper: false
            - name: Terraform Init
              id: init
              run: terraform init
            
            - name: Terraform Validate
              id: validate
              run: terraform validate

            - name: Terraform Plan
              id: plan
              run: terraform plan
              continue-on-error: true

            - name: Terraform Plan Status
              if: steps.plan.outcome == 'failure'
              run: exit 1



























